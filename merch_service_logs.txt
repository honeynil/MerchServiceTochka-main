{"time":"2025-06-24T17:49:28.260022029Z","level":"INFO","msg":"connected to Redis","addr":"redis:6379"}
{"time":"2025-06-24T17:49:28.260454034Z","level":"INFO","msg":"Starting server on :8080"}
{"time":"2025-06-24T17:50:25.18775667Z","level":"ERROR","msg":"user not found","method":"GetByUsername","username":"Dan","error":"sql: no rows in result set"}
{"time":"2025-06-24T17:50:25.193789053Z","level":"INFO","msg":"user created","method":"Create","username":"Dan","id":3}
{"time":"2025-06-24T17:50:25.193892492Z","level":"INFO","msg":"user registered successfully","user_id":3,"username":"Dan"}
{"time":"2025-06-24T17:50:25.193921282Z","level":"INFO","msg":"user registered","username":"Dan","event_id":"3"}
{"time":"2025-06-24T17:50:25.199575979Z","level":"INFO","msg":"user registration event sent","user_id":3,"username":"Dan"}
{"time":"2025-06-24T17:50:29.586486078Z","level":"INFO","msg":"Kafka message received","topic":"users","key":"3","value":"{\"created_at\":\"2025-06-24T17:50:25Z\",\"event_type\":\"user_registered\",\"user_id\":3,\"username\":\"Dan\"}"}
{"time":"2025-06-24T17:50:29.586556217Z","level":"ERROR","msg":"failed to create user","method":"Create","error":"password_hash is required"}
{"time":"2025-06-24T17:50:29.586585817Z","level":"ERROR","msg":"failed to create user","username":"Dan","error":"password_hash is required"}
{"time":"2025-06-24T17:50:30.529052943Z","level":"INFO","msg":"user retrieved by username","method":"GetByUsername","username":"Dan","id":3}
{"time":"2025-06-24T17:50:30.613908078Z","level":"INFO","msg":"key set","method":"Set","key":"user:3:token","expiration":3600000000000}
{"time":"2025-06-24T17:50:30.613947097Z","level":"INFO","msg":"user logged in","username":"Dan","user_id":3}
{"time":"2025-06-24T17:50:30.613956107Z","level":"INFO","msg":"user logged in","username":"Dan"}
{"time":"2025-06-24T17:50:44.341850384Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:50:44.341881364Z","level":"INFO","msg":"Getting balance","user_id":3}
{"time":"2025-06-24T17:50:44.341981552Z","level":"ERROR","msg":"key not found","method":"Get","key":"user:3:balance","error":"key not found"}
{"time":"2025-06-24T17:50:44.342482957Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T17:50:44.342592686Z","level":"INFO","msg":"key set","method":"Set","key":"user:3:balance","expiration":60000000000}
{"time":"2025-06-24T17:50:44.342605656Z","level":"INFO","msg":"Balance fetched from Postgres","user_id":3,"balance":1000}
{"time":"2025-06-24T17:50:44.342610795Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T17:57:42.437232873Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:57:42.437462421Z","level":"ERROR","msg":"key not found","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000","error":"key not found"}
{"time":"2025-06-24T17:57:42.437647249Z","level":"ERROR","msg":"key not found","method":"Get","key":"merch:123","error":"key not found"}
{"time":"2025-06-24T17:57:42.438318031Z","level":"ERROR","msg":"merch not found","method":"GetByID","merch_id":123,"error":"sql: no rows in result set"}
{"time":"2025-06-24T17:57:42.438362751Z","level":"ERROR","msg":"merch not found","merch_id":123,"error":"merch not found"}
{"time":"2025-06-24T17:57:42.438381331Z","level":"ERROR","msg":"buy failed","user_id":3,"merch_id":123,"request_id":"550e8400-e29b-41d4-a716-446655440000","error":"merch not found"}
{"time":"2025-06-24T17:57:49.371007198Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:57:49.371290455Z","level":"ERROR","msg":"key not found","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000","error":"key not found"}
{"time":"2025-06-24T17:57:49.371677291Z","level":"ERROR","msg":"key not found","method":"Get","key":"merch:10","error":"key not found"}
{"time":"2025-06-24T17:57:49.372273964Z","level":"INFO","msg":"merch retrieved by id","method":"GetByID","merch_id":10,"name":"pink0hoody"}
{"time":"2025-06-24T17:57:49.372475352Z","level":"INFO","msg":"key set","method":"Set","key":"merch:10","expiration":3600000000000}
{"time":"2025-06-24T17:57:49.372791998Z","level":"INFO","msg":"merch price retrieved","method":"GetPrice","merch_id":10,"price":500}
{"time":"2025-06-24T17:57:49.373114945Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T17:57:49.373258173Z","level":"INFO","msg":"key set","method":"Set","key":"request:550e8400-e29b-41d4-a716-446655440000","expiration":86400000000000}
{"time":"2025-06-24T17:57:49.373477221Z","level":"INFO","msg":"key deleted","method":"Del","key":"user:3:balance"}
{"time":"2025-06-24T17:57:49.37352099Z","level":"INFO","msg":"buy event sent","user_id":3,"merch_id":10,"event_id":1750787869373310413,"request_id":"550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:57:49.37354564Z","level":"INFO","msg":"merch purchased","user_id":3,"merch_id":10,"request_id":"550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:57:50.386500801Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:57:50.386694979Z","level":"INFO","msg":"key retrieved","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:57:50.386726968Z","level":"ERROR","msg":"request already processed","request_id":"550e8400-e29b-41d4-a716-446655440000","user_id":3}
{"time":"2025-06-24T17:57:50.386758088Z","level":"ERROR","msg":"buy failed","user_id":3,"merch_id":10,"request_id":"550e8400-e29b-41d4-a716-446655440000","error":"request alredy processed"}
{"time":"2025-06-24T17:57:50.636218238Z","level":"INFO","msg":"Kafka message received","topic":"transactions","key":"1750787869373310413","value":"{\"amount\":-500,\"created_at\":\"2025-06-24T17:57:49Z\",\"merch_id\":10,\"request_id\":\"550e8400-e29b-41d4-a716-446655440000\",\"status\":\"completed\",\"type\":\"purchase\",\"user_id\":3}"}
{"time":"2025-06-24T17:57:50.636601054Z","level":"INFO","msg":"key retrieved","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:57:50.636655063Z","level":"INFO","msg":"purchase already processed","request_id":"550e8400-e29b-41d4-a716-446655440000","user_id":3}
{"time":"2025-06-24T17:57:58.587053708Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:57:58.587388054Z","level":"INFO","msg":"key retrieved","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:57:58.587421973Z","level":"ERROR","msg":"request already processed","request_id":"550e8400-e29b-41d4-a716-446655440000","user_id":3}
{"time":"2025-06-24T17:57:58.587437243Z","level":"ERROR","msg":"buy failed","user_id":3,"merch_id":1,"request_id":"550e8400-e29b-41d4-a716-446655440000","error":"request alredy processed"}
{"time":"2025-06-24T17:57:59.491028583Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:57:59.491215051Z","level":"INFO","msg":"key retrieved","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:57:59.491230911Z","level":"ERROR","msg":"request already processed","request_id":"550e8400-e29b-41d4-a716-446655440000","user_id":3}
{"time":"2025-06-24T17:57:59.491237071Z","level":"ERROR","msg":"buy failed","user_id":3,"merch_id":1,"request_id":"550e8400-e29b-41d4-a716-446655440000","error":"request alredy processed"}
{"time":"2025-06-24T17:58:01.97317268Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T17:58:01.973335828Z","level":"INFO","msg":"key retrieved","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T17:58:01.973351688Z","level":"ERROR","msg":"request already processed","request_id":"550e8400-e29b-41d4-a716-446655440000","user_id":3}
{"time":"2025-06-24T17:58:01.973357288Z","level":"ERROR","msg":"buy failed","user_id":3,"merch_id":1,"request_id":"550e8400-e29b-41d4-a716-446655440000","error":"request alredy processed"}
{"time":"2025-06-24T18:10:16.919346991Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T18:10:16.919669517Z","level":"INFO","msg":"key retrieved","method":"Get","key":"request:550e8400-e29b-41d4-a716-446655440000"}
{"time":"2025-06-24T18:10:16.919748726Z","level":"ERROR","msg":"request already processed","request_id":"550e8400-e29b-41d4-a716-446655440000","user_id":3}
{"time":"2025-06-24T18:10:16.919762306Z","level":"ERROR","msg":"buy failed","user_id":3,"merch_id":1,"request_id":"550e8400-e29b-41d4-a716-446655440000","error":"request alredy processed"}
{"time":"2025-06-24T18:10:33.174630925Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T18:10:33.174665515Z","level":"INFO","msg":"Getting balance","user_id":3}
{"time":"2025-06-24T18:10:33.174778203Z","level":"ERROR","msg":"key not found","method":"Get","key":"user:3:balance","error":"key not found"}
{"time":"2025-06-24T18:10:33.175294638Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:33.175441647Z","level":"INFO","msg":"key set","method":"Set","key":"user:3:balance","expiration":60000000000}
{"time":"2025-06-24T18:10:33.175475566Z","level":"INFO","msg":"Balance fetched from Postgres","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:33.175489966Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:35.07972192Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T18:10:35.07976428Z","level":"INFO","msg":"Getting balance","user_id":3}
{"time":"2025-06-24T18:10:35.079857399Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:balance"}
{"time":"2025-06-24T18:10:35.079871209Z","level":"INFO","msg":"Balance fetched from Redis","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:35.079877709Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:40.054221752Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T18:10:40.054275482Z","level":"INFO","msg":"Getting balance","user_id":3}
{"time":"2025-06-24T18:10:40.05440181Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:balance"}
{"time":"2025-06-24T18:10:40.0544347Z","level":"INFO","msg":"Balance fetched from Redis","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:40.05445058Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:40.841634204Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:token"}
{"time":"2025-06-24T18:10:40.841680393Z","level":"INFO","msg":"Getting balance","user_id":3}
{"time":"2025-06-24T18:10:40.841794702Z","level":"INFO","msg":"key retrieved","method":"Get","key":"user:3:balance"}
{"time":"2025-06-24T18:10:40.841809972Z","level":"INFO","msg":"Balance fetched from Redis","user_id":3,"balance":1000}
{"time":"2025-06-24T18:10:40.841814912Z","level":"INFO","msg":"balance retrieved","user_id":3,"balance":1000}

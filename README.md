![TochkaCoinShop](/logo/d2.jpg)

# TochkaCoinShop

TochkaCoinShop — это сервис для сотрудников компании, позволяющий покупать мерч (например, футболки, кружки, книги) за TochkaCoin и переводить их друг другу! 

## Описание проекта

### Что это такое?

#### TochkaCoinShop предоставляет сотрудникам компании удобный способ:

- Регистрироваться и аутентифицироваться для доступа к сервису.
- Покупать мерч (например, футболки, кружки, книги) за TochkaCoin.
- Переводить монеты другим сотрудникам.
- Просматривать баланс и историю транзакций.

Сервис использует:
- **Go**: Основной язык для серверной логики.
- **PostgreSQL**: Хранение данных пользователей, транзакций и мерча.
- **Redis**: Кэширование JWT-токенов для аутентификации.
- **Kafka**: Асинхронная обработка событий (например, регистрация пользователей).
- **Jaeger**: Трассировка запросов для отладки.
- **Prometheus и Grafana**: Мониторинг и визуализация метрик.

### Для кого?
- **Сотрудники**: Для покупки мерча и переводов монет.

### Основные эндпоинты API

| Эндпоинт         | Метод | Описание                                                                 | Тело запроса / Заголовки                                | Ответ                                  |
|------------------|-------|--------------------------------------------------------------------------|--------------------------------------------------------|----------------------------------------|
| `/register`      | POST  | Регистрирует нового пользователя                                         | `{"username": "user1", "password": "pass1234"}`        | `{"event_id": "<uuid>"}` (201 Created) |
| `/login`         | POST  | Аутентифицирует пользователя, возвращает JWT-токен                      | `{"username": "user1", "password": "pass1234"}`        | `{"token": "<jwt>"}` (200 OK)          |
| `/buy`           | POST  | Покупает мерч по ID (требуется аутентификация)                           | `Authorization: Bearer <token>`, `{"merch_id": 1, "request_id": "<uuid>"}` | `{"status": "accepted"}` (202 Accepted) |
| `/transfer`      | POST  | Переводит монеты другому пользователю (требуется аутентификация)         | `Authorization: Bearer <token>`, `{"to_user_id": 2, "amount": 10}` | `{"status": "accepted"}` (202 Accepted) |
| `/balance`       | GET   | Возвращает текущий баланс пользователя (требуется аутентификация)        | `Authorization: Bearer <token>`                        | `{"balance": 100}` (200 OK)            |
| `/history`       | GET   | Возвращает историю транзакций пользователя (требуется аутентификация)    | `Authorization: Bearer <token>`                        | `[{...}, {...}]` (200 OK)              |

**Примечания**:
- Все защищённые эндпоинты (`/buy`, `/transfer`, `/balance`, `/history`) требуют заголовок `Authorization: Bearer <token>`, полученный через `/login`.
- Возможен префикс `/api` (например, `/api/register`, `/api/login`). Проверьте конфигурацию сервиса.

### Мониторинг и отладка
- **Grafana**: Метрики на `http://localhost:3000` (логин: `admin`, пароль: `admin`).
- **Jaeger**: Трассировка запросов на `http://localhost:16686`.
- **Prometheus**: Метрики на `http://localhost:9090`.

